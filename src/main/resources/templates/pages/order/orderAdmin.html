<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <title>Danh sách đơn hàng</title>
    <!-- base:css -->
    <link rel="stylesheet" th:href="@{../admin/vendors/mdi/css/materialdesignicons.min.css}">
    <link rel="stylesheet" th:href="@{../admin/vendors/css/vendor.bundle.base.css}">
    <!-- endinject -->
    <!-- inject:css -->
    <link rel="stylesheet" th:href="@{../admin/css/style.css}">
    <!-- endinject -->
    <link rel="shortcut icon" th:href="@{../admin/images/favicon.png}" />
</head>

<body>
    <div class="container-scroller d-flex">
        <!-- partial:../../partials/_sidebar.html -->
        <div class="offcanvas offcanvas-start" id="sidebarOffcanvas" th:insert="../templates/pages/sidebar.html"></div>
        <!-- partial -->
        <div class="container-fluid page-body-wrapper">
            <!-- partial:./partials/_navbar.html -->
            <div th:insert="../templates/pages/navbar.html"></div>
            <br>
            <div class="container">
                <div class="row mb-3">
                    <div class="col">
                        <h2 class="text-center" style="font-weight: bolder;">Danh sách đơn hàng</h2>
                    </div>
                </div>
                <form id="filterForm" th:action="@{/orderAdmin/filter}" method="get">
                    <div class="row mb-3">
                        <div class="col-md-3">
                            <select class="form-select" name="status" onchange="this.form.submit()">
                                <option value="default" th:selected="${status == 'default'}">Tất cả đơn hàng</option>
                                <option value="Completed" th:selected="${status == 'Completed'}">Thanh toán thành công
                                </option>
                                <option value="Pending" th:selected="${status == 'Pending'}">Đang thanh toán</option>
                                <option value="Reject" th:selected="${status == 'Reject'}">Đã bị hủy</option>
                                <option value="Error" th:selected="${status == 'Error'}">Bị lỗi</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="container">
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead>
                            <tr>
                                <th scope="col" class="fw-bold">Người mua</th>
                                <th scope="col" class="fw-bold">Trạng thái</th>
                                <th scope="col" class="fw-bold">Tổng tiền đơn hàng</th>
                                <th scope="col" class="fw-bold">Ngày thanh toán</th>
                                <th scope="col" class="fw-bold">Chi tiết đơn hàng</th>
                                <th scope="col" class="fw-bold">Hành động</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="order : ${listOrder}">
                                <td th:text="${order.user.firstName}"></td>
                                <td>
                                    <span th:class="${'badge ' +
                                    (order.status == 'Pending' ? 'bg-warning text-dark' :
                                    (order.status == 'Completed' ? 'bg-success' :
                                    (order.status == 'Reject' ? 'bg-danger' :
                                    (order.status == 'Error' ? 'bg-secondary' : 'bg-info'))))}">
                                        <span th:text="${order.status}"></span>
                                    </span>
                                </td>
                                <td
                                    th:text="${#numbers.formatDecimal(order.totalMoney, 1, 'POINT', 0, 'COMMA')} + ' VND'">
                                </td>
                                <td th:text="${order.orderDate}"></td>
                                <td>
                                    <a class="btn btn-sm btn-outline-primary"
                                        th:href="@{/orderAdmin/detail(id=${order.id})}">Chi Tiết</a>
                                </td>
                                <td>
                                    <a class="btn btn-sm btn-outline-danger"
                                        onclick="return confirm('Bạn có chắc muốn hủy đơn hàng này chứ?')"
                                        th:href="@{/orderAdmin/reject(id=${order.id})}"
                                        th:if="${order.status == 'Pending'}">Reject</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <hr>
            <div class="container">
                <nav aria-label="Page navigation example">
                    <ul class="pagination justify-content-center">
                        <li class="page-item"><a class="page-link" th:href="@{${action}+'pageNo='+${pageNo-1}}"
                                th:if="${pageNo>0}">Previous</a></li>
                        <li class="page-item"><a class="page-link" th:href="@{${action}+'pageNo=0'}"
                                th:style="${pageNo==0?'background: gainsboro;':''}">1</a></li>
                        <li class="page-item" th:if="${pageNo-1>0}"><a class="page-link"
                                style="display: inline-block;" th:href="@{${action}+'pageNo='+${pageNo-2}}"
                                th:if="${pageNo-2>0}">...</a><a class="page-link" style="display: inline-block;"
                                th:href="@{${action}+'pageNo='+${pageNo-1}}" th:text="${pageNo}"></a></li>
                        <li class="page-item" th:if="${pageNo!=0 }"><a class="page-link" href="#"
                                style="background: gainsboro;" th:text="${pageNo+1}"></a></li>
                        <li class="page-item" th:if="${pageNo+2<totalPages}"><a class="page-link"
                                style="display: inline-block;" th:href="@{${action}+'pageNo='+${pageNo+1}}"
                                th:text="${pageNo+2}"></a><a class="page-link" style="display: inline-block;"
                                th:href="@{${action}+'pageNo='+${pageNo+2}}"
                                th:if="${pageNo+3<totalPages}">...</a></li>
                        <li class="page-item" th:if="${totalPages-pageNo>1}"><a class="page-link"
                                th:href="@{${action}+'pageNo='+${totalPages-1}}"
                                th:style="${pageNo==totalPages-1?'background: gainsboro;':''}"
                                th:text="${totalPages}"></a></li>
                        <li class="page-item"><a class="page-link" th:href="@{${action}+'pageNo='+${pageNo+1}}"
                                th:if="${pageNo<totalPages-1}">Next</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <script th:src="@{../admin/vendors/js/vendor.bundle.base.js}"></script>
        <!-- endinject -->
        <!-- Plugin js for this page-->
        <script src="../admin/js/jquery.cookie.js" type="text/javascript"></script>
        <!-- End plugin js for this page-->
        <!-- inject:js -->
        <script src="../admin/js/off-canvas.js"></script>
        <script src="../admin/js/hoverable-collapse.js"></script>
        <script src="../admin/js/template.js"></script>
</body>

</html>